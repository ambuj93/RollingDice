<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>3D Dice Roller</title>
<style>
  :root { --size: 120px; --depth: calc(var(--size) / 2); --pip: 18px; }
  body {
    margin: 0; height: 100vh; display: grid; place-items: center;
    background: radial-gradient(1200px 600px at 50% 20%, #e9efff 0, #c9d8ff 40%, #90a8ff 100%);
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; overflow: hidden;
  }
  .wrap { display:flex; flex-direction:column; align-items:center; gap:18px; }
  .scene { width: var(--size); height: var(--size); perspective: 800px; }
  .dice {
    width:100%; height:100%; position:relative; transform-style:preserve-3d;
    /* IMPORTANT: no transition on transform to prevent the second spin */
    will-change: transform;
  }
  /* Single-direction spin keyframes; we apply inline with JS for exactly 1s */
  @keyframes spin1s {
    from { transform: rotateX(0deg) rotateY(0deg); }
    to   { transform: rotateX(720deg) rotateY(900deg); } /* one direction only */
  }

  .face {
    position:absolute; width:var(--size); height:var(--size);
    background:#fff; border-radius:14px; border:2px solid #d7d9e3;
    box-shadow: inset 0 0 16px rgba(0,0,0,.12), 0 6px 18px rgba(0,0,0,.18);
  }
  /* 3D placement */
  .front  { transform: rotateY(  0deg) translateZ(var(--depth)); }
  .back   { transform: rotateY(180deg) translateZ(var(--depth)); }
  .right  { transform: rotateY( 90deg) translateZ(var(--depth)); }
  .left   { transform: rotateY(-90deg) translateZ(var(--depth)); }
  .top    { transform: rotateX( 90deg) translateZ(var(--depth)); }
  .bottom { transform: rotateX(-90deg) translateZ(var(--depth)); }

  /* Realistic pip positions */
  .pip { position:absolute; width:var(--pip); height:var(--pip); background:#111; border-radius:50%; }
  .tl { top:14px; left:14px; } .tr { top:14px; right:14px; }
  .ml { top:50%; left:14px; transform:translateY(-50%); }
  .mr { top:50%; right:14px; transform:translateY(-50%); }
  .bl { bottom:14px; left:14px; } .br { bottom:14px; right:14px; }
  .c  { top:50%; left:50%; transform:translate(-50%,-50%); }

  button {
    padding:12px 22px; font-size:16px; border:none; border-radius:10px; color:#fff;
    background:#2563eb; box-shadow:0 8px 20px rgba(37,99,235,.35); cursor:pointer;
  }
  button:disabled { background:#a9b6f5; cursor:not-allowed; box-shadow:none; }
</style>
</head>
<body>
  <div class="wrap">
    <div class="scene">
      <div class="dice" id="dice">
        <!-- Face 1 (front) -->
        <div class="face front"><div class="pip c"></div></div>
        <!-- Face 6 (back) -->
        <div class="face back">
          <div class="pip tl"></div><div class="pip ml"></div><div class="pip bl"></div>
          <div class="pip tr"></div><div class="pip mr"></div><div class="pip br"></div>
        </div>
        <!-- Face 3 (right) -->
        <div class="face right">
          <div class="pip tl"></div><div class="pip c"></div><div class="pip br"></div>
        </div>
        <!-- Face 4 (left) -->
        <div class="face left">
          <div class="pip tl"></div><div class="pip bl"></div><div class="pip tr"></div><div class="pip br"></div>
        </div>
        <!-- Face 5 (top) -->
        <div class="face top">
          <div class="pip tl"></div><div class="pip bl"></div><div class="pip c"></div><div class="pip tr"></div><div class="pip br"></div>
        </div>
        <!-- Face 2 (bottom) -->
        <div class="face bottom"><div class="pip tl"></div><div class="pip br"></div></div>
      </div>
    </div>
    <button id="rollBtn">ðŸŽ² Roll Dice</button>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script>
    const dice = document.getElementById('dice');
    const rollBtn = document.getElementById('rollBtn');
    let busy = false;

    // Final orientations that bring each face to the front
    const faceToTransform = {
      1: 'rotateX(0deg) rotateY(0deg)',
      2: 'rotateX(-90deg) rotateY(0deg)',
      3: 'rotateX(0deg) rotateY(-90deg)',
      4: 'rotateX(0deg) rotateY(90deg)',
      5: 'rotateX(90deg) rotateY(0deg)',
      6: 'rotateX(0deg) rotateY(180deg)',
    };

    function roll() {
      if (busy) return;
      busy = true;
      rollBtn.disabled = true;

      // Start a single 1s spin animation in one direction.
      dice.style.animation = 'spin1s 1s linear 1 forwards';

      // When the spin ends, snap to the final face (no transition), then confetti if 6.
      const onEnd = () => {
        dice.removeEventListener('animationend', onEnd);
        // Stop the animation so we can control transform directly
        dice.style.animation = 'none';

        const result = Math.floor(Math.random() * 6) + 1;
        dice.style.transform = faceToTransform[result]; // snap, no extra spin

        if (result === 6) {
          confetti({ particleCount: 140, spread: 70, origin: { y: 0.15 } });
        }
        busy = false;
        rollBtn.disabled = false;
      };
      dice.addEventListener('animationend', onEnd, { once: true });
    }

    rollBtn.addEventListener('click', roll);
    // Also allow tap on cube
    dice.addEventListener('click', roll);
  </script>
</body>
</html>
